---
layout: post
title: MSSQL2008 R2使用中问题
category: sql
tags: [Pattern]
keywords: MSSQL
---

## SQL Server 2008登录错误:无法连接到(local)解决方法：
      服务器类型：数据库引擎
      服务器名称写上：计算机名\安装SQL Server时自己创建的实例名。如：ZH-PC\ZCDB。填(local)或.会报错（肯定前提数据库的服务得启动）。

## 拷贝数据库：
 ①数据库相同版本的导出备份
 ②用Navicat工具进行2个远程数据库的导入和导出(http://www.yishimei.cn/network/26.html)
 ③(未试)拷贝a.mdf,a.ldf到你的另外一台机器上.
      然后用sp_attach_db
      在查询分析器里面执行:
      EXEC sp_attach_db @dbname = N'pubs', 
     @filename1 = N'c:\Program Files\Microsoft SQL Server\MSSQL\Data\pubs.mdf', 
     @filename2 = N'c:\Program Files\Microsoft SQL Server\MSSQL\Data\pubs_log.ldf'

## char、varchar、nchar、nvarchar的区别(MSSQL)
对于程序中的string型字段，SQLServer中有char、varchar、nchar、nvarchar四种类型来对应（暂时不考虑text和ntext），开建立数据库中，对这四种类型往往比较模糊，这里做一下对比。

定长或变长
所谓定长就是长度固定的，当输入的数据长度没有达到指定的长度时将自动以英文空格在其后面填充，使长度达到相应的长度；有var前缀的，表示是实际存储空间是变长的，比如varchar,nvarchar变长字符数据则不会以空格填充，比较例外的是，text存储的也是可变长。
Unicode或非Unicode
数据库中，英文字符只需要一个字节存储就足够了，但汉字和其他众多非英文字符，则需要两个字节存储。如果英文与汉字同时存在，由于占用空间数不同，容易造成混乱，导致读取出来的字符串是乱码。Unicode字符集就是为了解决字符集这种不兼容的问题而产生的，它所有的字符都用两个字节表示，即英文字符也是用两个字节表示。而前缀n就表示Unicode字符，比如nchar,nvarchar，这两种类型使用了Unicode字符集。字节长度自然*2
基于以上两点来看看字段容量
char，varchar	最多8000个英文，4000个汉字
nchar，nvarchar	可存储4000个字符，无论英文还是汉字
使用(个人偏好) 
如果数据量非常大，又能100%确定长度且保存只是ansi字符，那么char 
能确定长度又不一定是ansi字符或者，那么用nchar； 
对于超大数据，如文章内容，使用nText 
其他的通用nvarchar
char、varchar、nchar、nvarchar特点比较
CHAR
CHAR存储定长数据很方便，CHAR字段上的索引效率级高，比如定义char(10)，那么不论你存储的数据是否达到了10个字节，都要占去10个字节的空间。
VARCHAR
存储变长数据，但存储效率没有CHAR高,如果一个字段可能的值是不固定长度的，我们只知道它不可能超过10个字符，把它定义为 VARCHAR(10)是最合算的。VARCHAR类型的实际长度是它的值的实际长度+1。为什么"+1"呢？这一个字节用于保存实际使用了多大的长度。
从空间上考虑，用varchar合适；从效率上考虑，用char合适，关键是根据实际情况找到权衡点。

TEXT
text存储可变长度的非Unicode数据，最大长度为2^31-1(2,147,483,647)个字符。
NCHAR、NVARCHAR、NTEXT
这三种从名字上看比前面三种多了个"N"。和char、varchar比较起来，nchar、nvarchar最多存储4000个字符，不论是英文还是汉字；而char、varchar最多能存储8000个英文，4000个汉字。可以看出使用nchar、nvarchar数据类型时不用担心输入的字符是英文还是汉字，较为方便，但在存储英文时数量上有些损失。
所以一般来说，如果含有中文字符，用nchar/nvarchar，如果纯英文和数字，用char/varchar。

## MSSQL——快捷键（转自http://blog.csdn.net/qy1387/article/details/7747477）
快捷键·F5
这个恐怕是最常用的快捷键了，用来代替那个“！执行”按钮，写完SQL语句后手不用离开键盘。虽然没什么技术含量，但不会用的人八成是菜鸟。

快捷键·CTRL+C/V
复制/粘贴。COPY流程序员神器，安全环保无污染。不多说，只会右键的同学直接定性为菜鸟。MS所有文本编辑器通用。

快捷键·↑↓←→
上下左右。功能全人类都知道。另外据本鸭验证，在SSMS启动时快速输入↑↑↓↓←→←→BABA没有加30条命效果。MS所有文本编辑器通用。

快捷键·SHIFT+↑↓←→
移动的同时选中移动范围内的代码，配合F5和其它命令用。MS所有文本编辑器通用。

快捷键·CTRL+↑↓
不移动光标，上下滑动查询窗口。效果等同按竖行滑动条拖。全键盘流同学和装B流同学可用。

快捷键·CTRL+←→
行内跳词移动光标。自己写个SELECT * FROM TB再试试这个就知道了。MS所有文本编辑器通用。

快捷键·CTRL+A
全选所有文本。用来清空编辑界面，或复制本界面全部语句时常用。MS所有文本编辑器通用。

快捷键·HOME/END
光标移动至本行首/尾。使用以下连招可选中本行文字：HOME -- SHIFT+END 或 END -- SHIFT+HOME。MS所有文本编辑器通用。

快捷键·CTRL+HOME/END
光标移动至全文首/尾。按住CTRL加上面那个连招能选中所有文字，效果同CTRL+A。另外在浏览超长SQL时，用滚轮会慢，用CTRL+END看最后一行的内容比较快。MS所有文本编辑器通用。

快捷键·TAB
不选中文本或选中部分文本时是添加一个制表符，选中整行或多行代码时按下是全部增加缩进。

快捷键·SHIT+TAB
不选中整行时无效果，选中整行或多行代码时是全部减少缩进。和上面那个功能一起练熟多用能让代码更有层次感，小清新流同学请多练习。

快捷键·CTRL+TAB
多个查询窗口之间切换，这个功能应该知道的人少一些，实际用的也不多，远不如ALT+TAB多，因为大多数人不会开太多查询窗口，多是在同一个窗口下做操作的。全键盘流同学和装B流同学必备，其它同学可以无视。

快捷键·（CTRL+）PAGEUP/PAGEDOWN
没什么内容，放在一起写了，不按CTRL时是光标换页，写SQL时用的不多，看TXT小说时用的更多。按住CTRL是移动光标到本页首行/尾行的第一格，个人认为有点鸡肋，欢迎有实际使用经验的同学补充。

快捷键·ALT+N
新建一个查询窗口。效果等同于SSMS左上角的新建查询，刚开始看别人用时觉得有装B嫌疑，自己用后发现确实蛮顺手。其实执行查询也可以用ALT+X，但不如F5用着爽，所以只推荐用这个。全键盘流同学必备，其它同学推荐使用。

快捷键·ALT+F+C+N
关闭当前查询窗口，不保存。相当于鼠标点“文件”--“关闭”，再在弹出的页面里点“否”。我是常用的，少用鼠标其实能加速不少，推荐同学们试试，用熟了也蛮快的。

快捷键·CTRL+K+C/U
注释/取消注释选中代码所在的行。配合SHIFT+↑↓，快速注释多行代码，没有注释的SQL不是好SQL，注释无意义的SQL也不是好SQL，存储过程不写注释是违法行为，珍爱生命，多写注释。

快捷键·CTRL+L
显示选中代码的执行计划。当别人问你一个语句怎么优化时，看着代码告诉他不知道 和 看着计划告诉他不知道 完全是两个层面的水平。DBA\数据库开发工程师\装B流菜鸟必备。

快捷键·F4
vs的程序员天天用，看属性的，在SSMS中用来看查询窗口的属性，我最常用的是看本窗口的SPID。为什么不运行 SELECT @@SPID看呢?因为正在运行一个查询，好长时间没完成，不能中止，只能通过这个方法看了。

快捷键·ALT+F1
查看选中表名的结构。选中表名按这个，等同于执行SP_HELP 表名，懒得打语句的同学可以用这个。另外，这个是可以改的，在选项里有。

快捷键·CTRL+ALT+A
眼熟吗？没错，就是QQ的截图快捷键。但是，当你关了QQ，到SSMS中再次按下这组键位时，你会发现，其实它还有另一个作用：打开当前实例的活动分析器，能看到N个非常非常非常非常有用的数据，DBA查错神器。但杯具的是，除了这个快捷键，我至今没有SSMS中找到这个窗口的打开按钮。。。。


